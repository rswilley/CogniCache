@using CogniCache.Application
@using CogniCache.Application.Queries
@using CogniCache.Domain.Repositories.TagRepository
@using CogniCache.Shared.Components

@inject IRequest<GetAllTagsQuery, GetAllTagsQueryResponse> getAllTagsQueryHandler

<Bar Breakpoint="Breakpoint.Desktop" NavigationBreakpoint="Breakpoint.Tablet" Background="Background.Dark" ThemeContrast="ThemeContrast.Dark"
Mode="BarMode.VerticalInline" CollapseMode="BarCollapseMode.Small" MenuToggleBehavior=BarMenuToggleBehavior.AllowSingleMenu>
    <BarToggler />
    <BarBrand>
        <BarItem>
            <BarLink To="">
                <BarIcon IconName="customIcon" />
                CogniCache
            </BarLink>
        </BarItem>
    </BarBrand>
    <BarMenu>
        <BarStart>
            <BarItem>
                <BarLink To="">
                    <BarIcon IconName="IconName.Dashboard" />
                    Dashboard
                </BarLink>
            </BarItem>
            <BarItem>
                <BarLink To="/notes">
                    <BarIcon IconName="IconName.StickyNote" />
                    Notes
                </BarLink>
            </BarItem>
            <BarItem>
                <BarDropdown>
                    <BarDropdownToggle>
                        <BarIcon IconName="IconName.Tag" />
                        Tags
                    </BarDropdownToggle>
                    <BarDropdownMenu>
                        @foreach (var tag in Tags) { 
                            <ChildDropdownItem Tag="tag" /> 
                        }
                    </BarDropdownMenu>
                </BarDropdown>
            </BarItem>
        </BarStart>
        <BarEnd>
            <BarItem>
                <BarDropdown>
                    <BarDropdownToggle>
                        <BarIcon IconName="IconName.Settings" />
                        Settings
                    </BarDropdownToggle>
                    <BarDropdownMenu>
                        <BarDropdownItem To="tests/utilities/borders">
                            Borders
                        </BarDropdownItem>
                        <BarDropdownItem To="tests/utilities/flex">
                            Flex
                        </BarDropdownItem>
                        <BarDropdownItem To="tests/utilities/grid">
                            Grid
                        </BarDropdownItem>
                        <BarDropdownItem To="tests/utilities/object-fit">
                            Object Fit
                        </BarDropdownItem>
                        <BarDropdownItem To="tests/utilities/overflow">
                            Overflow
                        </BarDropdownItem>
                        <BarDropdownItem To="tests/utilities/layout">
                            Layout
                        </BarDropdownItem>
                        <BarDropdownItem To="tests/utilities/position">
                            Position
                        </BarDropdownItem>
                        <BarDropdownItem To="tests/utilities/shadows">
                            Shadows
                        </BarDropdownItem>
                        <BarDropdownItem To="tests/utilities/sizing">
                            Sizing
                        </BarDropdownItem>
                        <BarDropdownItem To="tests/utilities/vertical-align">
                            Vertical align
                        </BarDropdownItem>
                        <BarDropdownItem To="tests/utilities/services">
                            Services
                        </BarDropdownItem>
                    </BarDropdownMenu>
                </BarDropdown>
            </BarItem>
        </BarEnd>
    </BarMenu>
</Bar>

@code {
    private IEnumerable<Tag> Tags = [];

    RenderFragment customIcon =@<img src="_content/CogniCache.Shared/img/cognicache-logo.png" style="width:40px; height: 40px" />;

    protected override void OnInitialized()
    {
        Tags = getAllTagsQueryHandler.Handle(new GetAllTagsQuery()).Tags;
    }
}